(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-27eb43f6"],{"06c5":function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("fb6a"),n("d3b7"),n("b0c0"),n("a630"),n("3ca3"),n("ac1f"),n("00b4");var o=n("6b75");function a(e,t){if(e){if("string"===typeof e)return Object(o["a"])(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(o["a"])(e,t):void 0}}},"4df4":function(e,t,n){"use strict";var o=n("0366"),a=n("7b0b"),s=n("9bdd"),i=n("e95a"),r=n("50c4"),l=n("8418"),c=n("35a1");e.exports=function(e){var t,n,d,u,h,f,g=a(e),p="function"==typeof this?this:Array,m=arguments.length,b=m>1?arguments[1]:void 0,w=void 0!==b,v=c(g),y=0;if(w&&(b=o(b,m>2?arguments[2]:void 0,2)),void 0==v||p==Array&&i(v))for(t=r(g.length),n=new p(t);t>y;y++)f=w?b(g[y],y):g[y],l(n,y,f);else for(u=v.call(g),h=u.next,n=new p;!(d=h.call(u)).done;y++)f=w?s(u,b,[d.value,y],!0):d.value,l(n,y,f);return n.length=y,n}},"6b75":function(e,t,n){"use strict";function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}n.d(t,"a",(function(){return o}))},"81a0":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{staticClass:"search"},[n("el-input",{staticStyle:{width:"200px","margin-right":"10px"},attrs:{placeholder:"请输入角色名"},model:{value:e.roleName,callback:function(t){e.roleName=t},expression:"roleName"}}),n("el-button",{attrs:{icon:"el-icon-search",type:"primary"},on:{click:e.searchRole}},[e._v("查询")]),n("el-button",{attrs:{icon:"el-icon-delete"},on:{click:e.clearSearchData}},[e._v("清空")])],1),n("div",{staticClass:"main"},[n("el-button",{attrs:{type:"primary"},on:{click:e.addRole}},[e._v("添加")]),n("el-button",{attrs:{type:"danger",disabled:e.selectionRoleId<1},on:{click:e.batchDeleteRole}},[e._v("批量删除")]),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.showLoadind,expression:"showLoadind"}],staticStyle:{width:"100%","margin-top":"10px"},attrs:{border:"",data:e.roleList},on:{"selection-change":e.selectionRole}},[n("el-table-column",{attrs:{type:"selection",label:"label",width:"60",align:"center"}}),n("el-table-column",{attrs:{type:"index",label:"序号",width:"80",align:"center"}}),n("el-table-column",{attrs:{prop:"roleName",label:"角色名",width:"300",align:"center"}}),n("el-table-column",{attrs:{prop:"gmtCreate",label:"创建时间",width:"360",align:"center"}}),n("el-table-column",{attrs:{prop:"gmtModified",label:"更新时间",width:"360",align:"center"}}),n("el-table-column",{attrs:{prop:"operate",label:"操作",width:"width",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.row;return[n("el-button",{attrs:{type:"info",icon:"el-icon-user"},on:{click:function(t){return e.menuPowerControl(o)}}}),n("el-button",{staticStyle:{"margin-right":"15px"},attrs:{type:"warning",icon:"el-icon-edit"},on:{click:function(t){return e.editRole(o)}}}),n("el-popconfirm",{attrs:{title:"确定删除该角色吗?"},on:{onConfirm:function(t){return e.deleteRole(o)}}},[n("el-button",{attrs:{slot:"reference",type:"danger",icon:"el-icon-delete"},slot:"reference"})],1)]}}])})],1),n("el-pagination",{staticStyle:{"text-align":"center","margin-top":"5px"},attrs:{"current-page":this.page,"page-sizes":[3,5,8,10],"page-size":this.limit,layout:"prev, pager, next, jumper,->,total,sizes",total:this.total},on:{"size-change":e.sizeChange,"current-change":e.pageChange}})],1),n("el-dialog",{attrs:{title:e.roleInfo.id?"修改角色":"添加角色",visible:e.showRoleDialog,width:"30%",center:""},on:{"update:visible":function(t){e.showRoleDialog=t},closed:e.cancel}},[n("el-form",{attrs:{"label-width":"120px"}},[n("el-form-item",{attrs:{label:"角色名"}},[n("el-input",{staticStyle:{width:"300px"},model:{value:e.roleInfo.roleName,callback:function(t){e.$set(e.roleInfo,"roleName",t)},expression:"roleInfo.roleName"}})],1)],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.cancel}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary"},on:{click:e.saveRole}},[e._v("确 定")])],1)],1),n("el-dialog",{attrs:{title:"菜单权限控制",visible:e.showMenuPowerDialog,"before-close":e.beforeClose},on:{"update:visible":function(t){e.showMenuPowerDialog=t},closed:e.cancel}},[n("el-tree",{attrs:{data:e.roleMenusList,"show-checkbox":"","node-key":"id","default-expanded-keys":["1"],accordion:"","default-checked-keys":e.selectedMenu},on:{check:e.checkMenu},scopedSlots:e._u([{key:"default",fn:function(t){var o=t.data;return n("span",{staticClass:"custom-tree-node"},[n("span",[e._v(e._s(o.name))])])}}])}),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{icon:e.showIconLoading?"el-icon-loading":"",disabled:e.showIconLoading},on:{click:e.cancel}},[e._v("放回")])],1)],1)],1)},a=[],s=n("6b75");function i(e){if(Array.isArray(e))return Object(s["a"])(e)}n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0"),n("a630");function r(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var l=n("06c5");function c(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e){return i(e)||r(e)||Object(l["a"])(e)||c()}var u=n("5530"),h=n("c7eb"),f=n("1da1"),g=(n("159b"),n("99af"),{name:"",data:function(){return{showIconLoading:!1,showLoadind:!1,showRoleDialog:!1,showMenuPowerDialog:!1,page:1,limit:5,total:0,roleName:"",roleId:"",roleInfo:{roleName:""},roleList:[],Searched:!1,selectionRoleId:[],roleMenusList:[],selectedMenu:[]}},methods:{getRolseList:function(e){var t=this;return Object(f["a"])(Object(h["a"])().mark((function n(){var o,a,s;return Object(h["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=t.page,a=t.limit,n.next=3,t.$API.roles.getRolesPageList(o,a,e);case 3:s=n.sent,2e4==s.code&&(t.showLoadind=!1,t.roleList=s.data.items,t.total=s.data.total,s.data.items<1?t.$message({type:"warning",message:"抱歉，没有该角色"}):(t.showLoadind=!1,t.roleList=s.data.items,t.total=s.data.total));case 5:case"end":return n.stop()}}),n)})))()},sizeChange:function(e){this.limit=e,this.showLoadind=!0,this.getRolseList()},pageChange:function(e){this.page=e,this.showLoadind=!0,this.getRolseList()},searchRole:function(){this.Searched=!0,this.showLoadind=!0,this.getRolseList(this.roleName)},clearSearchData:function(){""!=this.roleName&&(this.Searched?(this.roleName="",this.showLoadind=!0,this.getRolseList(),this.Searched=!1):this.roleName="")},addRole:function(){this.showRoleDialog=!0},editRole:function(e){this.showRoleDialog=!0,this.roleInfo=Object(u["a"])({},e)},saveRole:function(){var e=this;return Object(f["a"])(Object(h["a"])().mark((function t(){var n,o;return Object(h["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.roleInfo.id){t.next=7;break}return t.next=3,e.$API.roles.upDateRole(e.roleInfo);case 3:n=t.sent,2e4==n.code?(e.cancel(),e.showLoadind=!0,e.getRolseList(),e.$message({type:"success",message:"修改成功"})):e.$message({type:"warning",message:"修改失败"}),t.next=11;break;case 7:return t.next=9,e.$API.roles.addRole(e.roleInfo);case 9:o=t.sent,2e4==o.code?(e.cancel(),e.showLoadind=!0,e.getRolseList(),e.$message({type:"success",message:"保存成功"})):e.$message({type:"warning",message:"保存失败"});case 11:case"end":return t.stop()}}),t)})))()},cancel:function(){this.showRoleDialog=!1,this.showMenuPowerDialog=!1,this.roleInfo=this.$options.data().roleInfo,this.roleMenusList=[],this.selectedMenu=[]},deleteRole:function(e){var t=this;return Object(f["a"])(Object(h["a"])().mark((function n(){var o;return Object(h["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,t.$API.roles.deleteRole(e.id);case 2:o=n.sent,2e4==o.code?(t.$message({type:"success",message:"删除成功"}),t.showLoadind=!0,t.getRolseList()):t.$message({type:"warning",message:"删除失败，请稍后重试"});case 4:case"end":return n.stop()}}),n)})))()},selectionRole:function(e){var t=this;this.selectionRoleId=[],e.forEach((function(e){t.selectionRoleId.push(e.id)}))},batchDeleteRole:function(){var e=this;this.$confirm("此操作将永久删除该文件, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(f["a"])(Object(h["a"])().mark((function t(){var n;return Object(h["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$API.roles.ByIdbatchRole(e.selectionRoleId);case 2:n=t.sent,2e4==n.code?(e.$message({type:"success",message:"批量删除成功"}),e.showLoadind=!0,e.getRolseList()):e.$message({type:"warning",message:"批量删除失败"});case 4:case"end":return t.stop()}}),t)})))).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},menuPowerControl:function(e){var t=this;return Object(f["a"])(Object(h["a"])().mark((function n(){var o;return Object(h["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.showMenuPowerDialog=!0,t.roleId=e.id,n.next=4,t.$API.roles.ByRoleIdGetMenuList(e.id);case 4:o=n.sent,2e4==o.code&&(t.roleMenusList=o.data.children,t.computeSelect(t.roleMenusList),t.defaultSelectMenu(t.roleMenusList));case 6:case"end":return n.stop()}}),n)})))()},checkMenu:function(){var e=arguments,t=this;return Object(f["a"])(Object(h["a"])().mark((function n(){var o,a,s,i,r,l;return Object(h["a"])().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return t.showIconLoading=!0,o=e[1],a=o.checkedKeys,s=o.halfCheckedKeys,i=[].concat(d(a),d(s)),r=t.roleId,n.next=6,t.$API.roles.assignRoleMenuList({permissionIdList:i,roleId:r});case 6:l=n.sent,2e4==l.code?(t.showIconLoading=!1,t.$message({type:"success",message:"设置成功"})):t.$message({type:"warning",message:"设置失败"});case 8:case"end":return n.stop()}}),n)})))()},beforeClose:function(e){this.showIconLoading?this.$notify({title:"警告",message:"正在设置权限，请勿关闭弹窗",type:"warning"}):e()},computeSelect:function(e){var t=this;e.forEach((function(e){if(e.select&&e.children&&e.children.length>0){var n=e.children.some((function(e){return!1===e.select}));n&&(e.select=!1,3!==e.level&&t.computeSelect(e.children))}}))},defaultSelectMenu:function(e){var t=this;e.forEach((function(e){e.select?(t.selectedMenu.push(e.id),e.children&&e.children.length>0&&t.defaultSelectMenu(e.children)):e.children&&e.children.length>0&&t.defaultSelectMenu(e.children)}))}},mounted:function(){this.showLoadind=!0,this.getRolseList()},computed:{}}),p=g,m=(n("884a"),n("2877")),b=Object(m["a"])(p,o,a,!1,null,"c4eaae1c",null);t["default"]=b.exports},"884a":function(e,t,n){"use strict";n("bdc7")},a630:function(e,t,n){var o=n("23e7"),a=n("4df4"),s=n("1c7e"),i=!s((function(e){Array.from(e)}));o({target:"Array",stat:!0,forced:i},{from:a})},bdc7:function(e,t,n){}}]);